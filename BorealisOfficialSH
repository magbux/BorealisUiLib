local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local TextService = game:GetService("TextService")

local Borealis = {}
local UIConfig = { Keybind = Enum.KeyCode.RightControl }

-- Animation Config
local TweenInfo_Hover = TweenInfo.new(0.2, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
local TweenInfo_Click = TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local TweenInfo_Tab = TweenInfo.new(0.35, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
local TweenInfo_Line = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)

local Theme = {
    Background = Color3.fromRGB(24, 24, 24),
    Glow = Color3.fromRGB(0, 0, 0),
    Accent = Color3.fromRGB(60, 180, 255),
    LightContrast = Color3.fromRGB(30, 30, 30),
    DarkContrast = Color3.fromRGB(20, 20, 20),
    TextColor = Color3.fromRGB(255, 255, 255)
}

if game.CoreGui:FindFirstChild("BorealisUI") then
    game.CoreGui.BorealisUI:Destroy()
end

local function Create(class, properties)
    local instance = Instance.new(class)
    for k, v in pairs(properties) do
        instance[k] = v
    end
    return instance
end

local function AddRipple(Button)
    Button.ClipsDescendants = true
    Button.MouseButton1Down:Connect(function(Input)
        task.spawn(function()
            local Ripple = Instance.new("ImageLabel")
            Ripple.Name = "Ripple"
            Ripple.Parent = Button
            Ripple.BackgroundTransparency = 1
            Ripple.BorderSizePixel = 0
            Ripple.Image = "rbxassetid://2708891598"
            Ripple.ImageColor3 = Color3.fromRGB(255, 255, 255)
            Ripple.ImageTransparency = 0.8
            Ripple.ZIndex = 9

            local X = Input.Position.X - Button.AbsolutePosition.X
            local Y = Input.Position.Y - Button.AbsolutePosition.Y
            Ripple.Position = UDim2.new(0, X, 0, Y)
            Ripple.Size = UDim2.new(0, 0, 0, 0)

            local SizeAnim = TweenService:Create(Ripple, TweenInfo.new(0.4), {Size = UDim2.new(0, 500, 0, 500), Position = UDim2.new(0, X - 250, 0, Y - 250)})
            local FadeAnim = TweenService:Create(Ripple, TweenInfo.new(0.4), {ImageTransparency = 1})

            SizeAnim:Play()
            FadeAnim:Play()
            
            task.wait(0.4)
            Ripple:Destroy()
        end)
    end)
end

function Borealis.new(title)
    local Library = {}
    
    local ScreenGui = Create("ScreenGui", {
        Name = "BorealisUI",
        Parent = CoreGui,
        ResetOnSpawn = false
    })
    
    -- // NOTIFICATION SYSTEM //
    local NotificationHolder = Create("Frame", {
        Name = "Notifications",
        Parent = ScreenGui,
        BackgroundTransparency = 1,
        Position = UDim2.new(1, -320, 1, -20), -- Bottom Right
        Size = UDim2.new(0, 300, 1, 0),
        AnchorPoint = Vector2.new(0, 1)
    })
    
    local NotifLayout = Create("UIListLayout", {
        Parent = NotificationHolder,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 5),
        VerticalAlignment = Enum.VerticalAlignment.Bottom
    })

    function Library:Notification(props)
        local Title = props.Title or "Notification"
        local Content = props.Content or "Text"
        local Duration = props.Duration or 3
        
        local NotifFrame = Create("Frame", {
            Parent = NotificationHolder,
            BackgroundColor3 = Theme.LightContrast,
            BorderSizePixel = 0,
            Size = UDim2.new(1, 0, 0, 0), -- Animated height
            ClipsDescendants = true
        })
        Create("UICorner", {Parent = NotifFrame, CornerRadius = UDim.new(0, 6)})
        
        local Glow = Create("Frame", {
            Parent = NotifFrame,
            BackgroundColor3 = Theme.Accent,
            BorderSizePixel = 0,
            Size = UDim2.new(0, 4, 1, 0)
        })

        local TitleLabel = Create("TextLabel", {
            Parent = NotifFrame,
            BackgroundTransparency = 1,
            Position = UDim2.new(0, 14, 0, 5),
            Size = UDim2.new(1, -20, 0, 20),
            Font = Enum.Font.GothamBold,
            Text = Title,
            TextColor3 = Theme.TextColor,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left
        })

        local ContentLabel = Create("TextLabel", {
            Parent = NotifFrame,
            BackgroundTransparency = 1,
            Position = UDim2.new(0, 14, 0, 25),
            Size = UDim2.new(1, -20, 0, 30),
            Font = Enum.Font.Gotham,
            Text = Content,
            TextColor3 = Color3.fromRGB(200, 200, 200),
            TextSize = 13,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextWrapped = true
        })
        
        -- Animation In
        local targetSize = UDim2.new(1, 0, 0, 60)
        local openTween = TweenService:Create(NotifFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Size = targetSize})
        openTween:Play()
        
        task.spawn(function()
            task.wait(Duration)
            local closeTween = TweenService:Create(NotifFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Size = UDim2.new(1, 0, 0, 0)})
            closeTween:Play()
            closeTween.Completed:Wait()
            NotifFrame:Destroy()
        end)
    end
    
    local Main = Create("Frame", {
        Name = "Main",
        Parent = ScreenGui,
        BackgroundColor3 = Theme.Background,
        BorderSizePixel = 0,
        Position = UDim2.new(0.5, -275, 0.5, -175),
        Size = UDim2.new(0, 550, 0, 350),
        ClipsDescendants = true
    })
    
    Create("UICorner", {Parent = Main, CornerRadius = UDim.new(0, 6)})
    
    local TopBar = Create("Frame", {
        Name = "TopBar",
        Parent = Main,
        BackgroundColor3 = Theme.LightContrast,
        BorderSizePixel = 0,
        Size = UDim2.new(1, 0, 0, 40)
    })
    Create("UICorner", {Parent = TopBar, CornerRadius = UDim.new(0, 6)})
    -- Fix corner clipping at bottom of topbar
    local TopBarFiller = Create("Frame", {
        Parent = TopBar,
        BackgroundColor3 = Theme.LightContrast,
        BorderSizePixel = 0,
        Position = UDim2.new(0,0,1,-5),
        Size = UDim2.new(1,0,0,5)
    })
    
    Create("TextLabel", {
        Parent = TopBar,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 15, 0, 0),
        Size = UDim2.new(0, 200, 1, 0),
        Font = Enum.Font.GothamBold,
        Text = title,
        TextColor3 = Theme.TextColor,
        TextSize = 16,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 2
    })
    
    local CloseBtn = Create("TextButton", {
        Parent = TopBar,
        BackgroundTransparency = 1,
        Position = UDim2.new(1, -35, 0, 5),
        Size = UDim2.new(0, 30, 0, 30),
        Font = Enum.Font.GothamBold,
        Text = "X",
        TextColor3 = Color3.fromRGB(150, 150, 150),
        TextSize = 16,
        ZIndex = 2
    })
    
    function Library:Unload()
        local closeTween = TweenService:Create(Main, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        })
        closeTween:Play()
        
        for _, v in pairs(Main:GetDescendants()) do
            if v:IsA("GuiObject") then
                TweenService:Create(v, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
            end
            if v:IsA("TextLabel") or v:IsA("TextButton") then
                TweenService:Create(v, TweenInfo.new(0.3), {TextTransparency = 1}):Play()
            end
        end

        closeTween.Completed:Wait()
        ScreenGui:Destroy()
    end

    function Library:toggle()
        if Main.Visible then
            local tween = TweenService:Create(Main, TweenInfo.new(0.2), {Size = UDim2.new(0, 550, 0, 0)})
            tween:Play()
            tween.Completed:Wait()
            Main.Visible = false
            Main.ClipsDescendants = true
        else
            Main.Visible = true
            TweenService:Create(Main, TweenInfo.new(0.3, Enum.EasingStyle.Back), {Size = UDim2.new(0, 550, 0, 350)}):Play()
        end
    end

    CloseBtn.MouseButton1Click:Connect(function()
        Library:Unload()
    end)
    
    local Dragging, DragInput, DragStart, StartPos
    TopBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            Dragging = true
            DragStart = input.Position
            StartPos = Main.Position
        end
    end)
    TopBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then DragInput = input end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            local delta = input.Position - DragStart
            TweenService:Create(Main, TweenInfo.new(0.05), {
                Position = UDim2.new(StartPos.X.Scale, StartPos.X.Offset + delta.X, StartPos.Y.Scale, StartPos.Y.Offset + delta.Y)
            }):Play()
        end
    end)
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then Dragging = false end
    end)
    
    local Sidebar = Create("Frame", {
        Name = "Sidebar",
        Parent = Main,
        BackgroundColor3 = Theme.LightContrast,
        BorderSizePixel = 0,
        Position = UDim2.new(0, 0, 0, 40),
        Size = UDim2.new(0, 130, 1, -40)
    })
    
    local TabContainer = Create("ScrollingFrame", {
        Parent = Sidebar,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, -10),
        Position = UDim2.new(0, 0, 0, 10),
        ScrollBarThickness = 0,
        ScrollingEnabled = false 
    })
    
    local TabLayout = Create("UIListLayout", {
        Parent = TabContainer,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 5)
    })
    
    local Pages = Create("Frame", {
        Name = "Pages",
        Parent = Main,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 140, 0, 50),
        Size = UDim2.new(1, -150, 1, -60),
        ClipsDescendants = true 
    })
    
    UserInputService.InputBegan:Connect(function(input, gp)
        if not gp and input.KeyCode == UIConfig.Keybind then
            Library:toggle()
        end
    end)

    local Tabs = {}
    local First = true
    local CurrentTab = nil
    
    function Library:MakeTab(name)
        local TabBtn = Create("TextButton", {
            Parent = TabContainer,
            BackgroundColor3 = Theme.LightContrast,
            BorderSizePixel = 0,
            Size = UDim2.new(1, 0, 0, 30),
            Font = Enum.Font.GothamMedium,
            Text = name,
            TextColor3 = Color3.fromRGB(150, 150, 150),
            TextSize = 13,
            AutoButtonColor = false
        })
        
        local Indicator = Create("Frame", {
            Parent = TabBtn,
            BackgroundColor3 = Theme.Accent,
            BorderSizePixel = 0,
            AnchorPoint = Vector2.new(0, 0.5),
            Position = UDim2.new(0, 0, 0.5, 0),
            Size = UDim2.new(0, 3, 0, 0), 
            Visible = true
        })

        local Page = Create("ScrollingFrame", {
            Name = name .. "Page",
            Parent = Pages,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 1, 0),
            ScrollBarThickness = 2,
            ScrollBarImageColor3 = Theme.Accent,
            Visible = false,
            CanvasSize = UDim2.new(0, 0, 0, 0) 
        })
        
        Create("UIPadding", {
            Parent = Page,
            PaddingTop = UDim.new(0, 12),
            PaddingLeft = UDim.new(0, 12),
            PaddingRight = UDim.new(0, 12),
            PaddingBottom = UDim.new(0, 12)
        })

        local PageLayout = Create("UIListLayout", {
            Parent = Page,
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 12) 
        })
        
        PageLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            Page.CanvasSize = UDim2.new(0, 0, 0, PageLayout.AbsoluteContentSize.Y + 24)
        end)
        
        TabBtn.MouseButton1Click:Connect(function()
            if CurrentTab == Page then return end
            
            for _, t in pairs(Tabs) do
                if t.Page.Visible then
                    TweenService:Create(t.Btn, TweenInfo_Hover, {TextColor3 = Color3.fromRGB(150, 150, 150)}):Play()
                    TweenService:Create(t.Ind, TweenInfo_Line, {Size = UDim2.new(0, 3, 0, 0)}):Play()
                    t.Page.Visible = false
                end
            end
            
            CurrentTab = Page
            Page.Visible = true
            
            TweenService:Create(Indicator, TweenInfo_Line, {Size = UDim2.new(0, 3, 1, 0)}):Play()
            TweenService:Create(TabBtn, TweenInfo_Hover, {TextColor3 = Theme.TextColor}):Play()
            
            -- Simple Fade In
            Page.CanvasPosition = Vector2.new(0,0)
            for _, child in pairs(Page:GetChildren()) do
                if child:IsA("GuiObject") then
                    child.BackgroundTransparency = 1
                    TweenService:Create(child, TweenInfo.new(0.3), {BackgroundTransparency = (child.Name == "ToggleBox" or child.Name:find("Box") or child.Name:find("Button")) and 0 or 1}):Play()
                end
            end
        end)
        
        if First then
            First = false
            CurrentTab = Page
            Page.Visible = true
            TabBtn.TextColor3 = Theme.TextColor
            Indicator.Size = UDim2.new(0, 3, 1, 0)
        end
        
        table.insert(Tabs, {Btn = TabBtn, Page = Page, Ind = Indicator})
        
        local Section = {}
        function Section:AddSection() return Section end
        
        -- [[ TOGGLE ]]
        function Section:AddToggle(props)
            local ToggleBox = Create("Frame", {
                Name = "ToggleBox",
                Parent = Page,
                BackgroundColor3 = Theme.LightContrast,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 36)
            })
            Create("UICorner", {Parent = ToggleBox, CornerRadius = UDim.new(0, 4)})
            
            Create("TextLabel", {
                Parent = ToggleBox,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 0),
                Size = UDim2.new(1, -50, 1, 0),
                Font = Enum.Font.Gotham,
                Text = props.Name,
                TextColor3 = Theme.TextColor,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local Checkbox = Create("TextButton", {
                Parent = ToggleBox,
                BackgroundColor3 = Theme.DarkContrast,
                BorderSizePixel = 0,
                Position = UDim2.new(1, -30, 0.5, -10),
                Size = UDim2.new(0, 20, 0, 20),
                Text = "",
                AutoButtonColor = false
            })
            Create("UICorner", {Parent = Checkbox, CornerRadius = UDim.new(0, 4)})
            
            AddRipple(Checkbox)
            
            local State = props.Default or false
            local function Update()
                TweenService:Create(Checkbox, TweenInfo_Hover, {BackgroundColor3 = State and Theme.Accent or Theme.DarkContrast}):Play()
            end
            Update()
            
            Checkbox.MouseButton1Click:Connect(function()
                State = not State
                Update()
                if props.Callback then props.Callback(State) end
            end)
        end
        
        -- [[ BUTTON ]]
        function Section:AddButton(props)
            local Button = Create("TextButton", {
                Parent = Page,
                BackgroundColor3 = Theme.LightContrast,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 36),
                Font = Enum.Font.Gotham,
                Text = props.Name,
                TextColor3 = Theme.TextColor,
                TextSize = 13,
                AutoButtonColor = false
            })
            Create("UICorner", {Parent = Button, CornerRadius = UDim.new(0, 4)})
            
            AddRipple(Button)
            
            Button.MouseEnter:Connect(function()
                TweenService:Create(Button, TweenInfo_Hover, {BackgroundColor3 = Color3.fromRGB(45, 45, 45)}):Play()
            end)
            Button.MouseLeave:Connect(function()
                TweenService:Create(Button, TweenInfo_Hover, {BackgroundColor3 = Theme.LightContrast}):Play()
            end)
            
            Button.MouseButton1Click:Connect(function()
                if props.Callback then props.Callback() end
            end)
        end
        
        -- [[ SLIDER ]]
        function Section:AddSlider(props)
            local SliderBox = Create("Frame", {
                Name = "SliderBox",
                Parent = Page,
                BackgroundColor3 = Theme.LightContrast,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 50)
            })
            Create("UICorner", {Parent = SliderBox, CornerRadius = UDim.new(0, 4)})
            
            Create("TextLabel", {
                Parent = SliderBox,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 5),
                Size = UDim2.new(1, -20, 0, 20),
                Font = Enum.Font.Gotham,
                Text = props.Name,
                TextColor3 = Theme.TextColor,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local ValueText = Create("TextLabel", {
                Parent = SliderBox,
                BackgroundTransparency = 1,
                Position = UDim2.new(1, -60, 0, 5),
                Size = UDim2.new(0, 50, 0, 20),
                Font = Enum.Font.GothamBold,
                Text = tostring(props.Default or props.Min),
                TextColor3 = Theme.TextColor,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Right
            })
            
            local SlideTrack = Create("TextButton", {
                Parent = SliderBox,
                BackgroundColor3 = Theme.DarkContrast,
                BorderSizePixel = 0,
                Position = UDim2.new(0, 10, 0, 32),
                Size = UDim2.new(1, -20, 0, 4),
                Text = "",
                AutoButtonColor = false
            })
            Create("UICorner", {Parent = SlideTrack, CornerRadius = UDim.new(0, 2)})
            
            local Fill = Create("Frame", {
                Parent = SlideTrack,
                BackgroundColor3 = Theme.Accent,
                BorderSizePixel = 0,
                Size = UDim2.new(0, 0, 1, 0)
            })
            Create("UICorner", {Parent = Fill, CornerRadius = UDim.new(0, 2)})
            
            local min, max, def = props.Min or 0, props.Max or 100, props.Default or 0
            Fill.Size = UDim2.new((def - min)/(max - min), 0, 1, 0)
            
            local Dragging = false
            
            local function Update(input)
                local pos = math.clamp((input.Position.X - SlideTrack.AbsolutePosition.X) / SlideTrack.AbsoluteSize.X, 0, 1)
                local val = math.floor(min + (max - min) * pos)
                
                TweenService:Create(Fill, TweenInfo.new(0.1), {Size = UDim2.new(pos, 0, 1, 0)}):Play()
                ValueText.Text = tostring(val)
                if props.Callback then props.Callback(val) end
            end
            
            SlideTrack.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    Dragging = true
                    Update(input)
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if Dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    Update(input)
                end
            end)
            
            UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then Dragging = false end
            end)
        end

        -- [[ DROPDOWN ]]
        function Section:AddDropdown(props)
            local Dropdown = Create("Frame", {
                Name = "Dropdown",
                Parent = Page,
                BackgroundColor3 = Theme.LightContrast,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 36),
                ClipsDescendants = true
            })
            Create("UICorner", {Parent = Dropdown, CornerRadius = UDim.new(0, 4)})

            local Text = Create("TextLabel", {
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 0),
                Size = UDim2.new(1, -40, 0, 36),
                Font = Enum.Font.Gotham,
                Text = props.Name .. ": " .. (props.Default or "None"),
                TextColor3 = Theme.TextColor,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            local OpenBtn = Create("TextButton", {
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Size = UDim2.new(1, 0, 0, 36),
                Text = "",
                ZIndex = 2
            })
            AddRipple(OpenBtn)
            
            local Arrow = Create("TextLabel", {
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Position = UDim2.new(1, -30, 0, 0),
                Size = UDim2.new(0, 30, 0, 36),
                Font = Enum.Font.GothamBold,
                Text = "V",
                TextColor3 = Color3.fromRGB(150, 150, 150),
                TextSize = 12
            })

            local ItemHolder = Create("ScrollingFrame", {
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 0, 0, 36),
                Size = UDim2.new(1, 0, 0, 100),
                CanvasSize = UDim2.new(0,0,0,0),
                ScrollBarThickness = 2,
                ScrollBarImageColor3 = Theme.Accent
            })
            
            local ItemLayout = Create("UIListLayout", {
                Parent = ItemHolder,
                SortOrder = Enum.SortOrder.LayoutOrder,
                Padding = UDim.new(0, 4) 
            })
            
            ItemLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                ItemHolder.CanvasSize = UDim2.new(0,0,0, ItemLayout.AbsoluteContentSize.Y)
            end)

            local Open = false
            
            OpenBtn.MouseButton1Click:Connect(function()
                Open = not Open
                if Open then
                    local count = #props.Items
                    local h = math.clamp(count * 28 + 10, 0, 140)
                    TweenService:Create(Dropdown, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(1, 0, 0, 36 + h)}):Play()
                    TweenService:Create(Arrow, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Rotation = 180}):Play()
                else
                    TweenService:Create(Dropdown, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(1, 0, 0, 36)}):Play()
                    TweenService:Create(Arrow, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Rotation = 0}):Play()
                end
            end)

            for _, item in pairs(props.Items or {}) do
                local ItemBtn = Create("TextButton", {
                    Parent = ItemHolder,
                    BackgroundColor3 = Theme.DarkContrast,
                    BorderSizePixel = 0,
                    Size = UDim2.new(1, -4, 0, 24),
                    Font = Enum.Font.Gotham,
                    Text = item,
                    TextColor3 = Color3.fromRGB(200, 200, 200),
                    TextSize = 12,
                    AutoButtonColor = false
                })
                Create("UICorner", {Parent = ItemBtn, CornerRadius = UDim.new(0, 4)})
                
                ItemBtn.MouseEnter:Connect(function()
                    TweenService:Create(ItemBtn, TweenInfo.new(0.2), {BackgroundColor3 = Theme.Accent, TextColor3 = Color3.new(1,1,1)}):Play()
                end)
                ItemBtn.MouseLeave:Connect(function()
                    TweenService:Create(ItemBtn, TweenInfo.new(0.2), {BackgroundColor3 = Theme.DarkContrast, TextColor3 = Color3.fromRGB(200,200,200)}):Play()
                end)
                
                ItemBtn.MouseButton1Click:Connect(function()
                    Open = false
                    Text.Text = props.Name .. ": " .. item
                    TweenService:Create(Dropdown, TweenInfo.new(0.4, Enum.EasingStyle.Quart), {Size = UDim2.new(1, 0, 0, 36)}):Play()
                    TweenService:Create(Arrow, TweenInfo.new(0.4, Enum.EasingStyle.Quart), {Rotation = 0}):Play()
                    if props.Callback then props.Callback(item) end
                end)
            end
        end

        -- [[ MULTI DROPDOWN ]]
        function Section:AddMultiDropdown(props)
            local Dropdown = Create("Frame", {
                Name = "MultiDropdown",
                Parent = Page,
                BackgroundColor3 = Theme.LightContrast,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 36),
                ClipsDescendants = true
            })
            Create("UICorner", {Parent = Dropdown, CornerRadius = UDim.new(0, 4)})

            local SelectedItems = {}
            local function UpdateText()
                if #SelectedItems == 0 then
                    return props.Name .. ": None"
                elseif #SelectedItems == 1 then
                     return props.Name .. ": " .. SelectedItems[1]
                else
                    return props.Name .. ": " .. #SelectedItems .. " Selected"
                end
            end

            local Text = Create("TextLabel", {
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 0),
                Size = UDim2.new(1, -40, 0, 36),
                Font = Enum.Font.Gotham,
                Text = UpdateText(),
                TextColor3 = Theme.TextColor,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            local OpenBtn = Create("TextButton", {
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Size = UDim2.new(1, 0, 0, 36),
                Text = "",
                ZIndex = 2
            })
            AddRipple(OpenBtn)
            
            local Arrow = Create("TextLabel", {
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Position = UDim2.new(1, -30, 0, 0),
                Size = UDim2.new(0, 30, 0, 36),
                Font = Enum.Font.GothamBold,
                Text = "V",
                TextColor3 = Color3.fromRGB(150, 150, 150),
                TextSize = 12
            })

            local ItemHolder = Create("ScrollingFrame", {
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 0, 0, 36),
                Size = UDim2.new(1, 0, 0, 100),
                CanvasSize = UDim2.new(0,0,0,0),
                ScrollBarThickness = 2,
                ScrollBarImageColor3 = Theme.Accent
            })
            
            local ItemLayout = Create("UIListLayout", {
                Parent = ItemHolder,
                SortOrder = Enum.SortOrder.LayoutOrder,
                Padding = UDim.new(0, 4) 
            })
            
            ItemLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                ItemHolder.CanvasSize = UDim2.new(0,0,0, ItemLayout.AbsoluteContentSize.Y)
            end)

            local Open = false
            OpenBtn.MouseButton1Click:Connect(function()
                Open = not Open
                if Open then
                    local count = #props.Items
                    local h = math.clamp(count * 28 + 10, 0, 140)
                    TweenService:Create(Dropdown, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(1, 0, 0, 36 + h)}):Play()
                    TweenService:Create(Arrow, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Rotation = 180}):Play()
                else
                    TweenService:Create(Dropdown, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(1, 0, 0, 36)}):Play()
                    TweenService:Create(Arrow, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Rotation = 0}):Play()
                end
            end)

            for _, item in pairs(props.Items or {}) do
                local ItemBtn = Create("TextButton", {
                    Parent = ItemHolder,
                    BackgroundColor3 = Theme.DarkContrast,
                    BorderSizePixel = 0,
                    Size = UDim2.new(1, -4, 0, 24),
                    Font = Enum.Font.Gotham,
                    Text = item,
                    TextColor3 = Color3.fromRGB(200, 200, 200),
                    TextSize = 12,
                    AutoButtonColor = false
                })
                Create("UICorner", {Parent = ItemBtn, CornerRadius = UDim.new(0, 4)})
                
                ItemBtn.MouseButton1Click:Connect(function()
                    if table.find(SelectedItems, item) then
                        table.remove(SelectedItems, table.find(SelectedItems, item))
                        TweenService:Create(ItemBtn, TweenInfo.new(0.2), {BackgroundColor3 = Theme.DarkContrast, TextColor3 = Color3.fromRGB(200,200,200)}):Play()
                    else
                        table.insert(SelectedItems, item)
                        TweenService:Create(ItemBtn, TweenInfo.new(0.2), {BackgroundColor3 = Theme.Accent, TextColor3 = Color3.new(1,1,1)}):Play()
                    end
                    Text.Text = UpdateText()
                    if props.Callback then props.Callback(SelectedItems) end
                end)
            end
        end

        -- [[ COLOR PICKER ]]
        function Section:AddColorPicker(props)
            local ColorFrame = Create("Frame", {
                Name = "ColorPicker",
                Parent = Page,
                BackgroundColor3 = Theme.LightContrast,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 36),
                ClipsDescendants = true
            })
            Create("UICorner", {Parent = ColorFrame, CornerRadius = UDim.new(0, 4)})

            Create("TextLabel", {
                Parent = ColorFrame,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 0),
                Size = UDim2.new(1, -50, 0, 36),
                Font = Enum.Font.Gotham,
                Text = props.Name,
                TextColor3 = Theme.TextColor,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local CurrentColor = props.Default or Color3.fromRGB(255, 255, 255)
            
            local ColorPreview = Create("TextButton", {
                Parent = ColorFrame,
                BackgroundColor3 = CurrentColor,
                BorderSizePixel = 0,
                Position = UDim2.new(1, -40, 0, 6),
                Size = UDim2.new(0, 30, 0, 24),
                Text = "",
                AutoButtonColor = false
            })
            Create("UICorner", {Parent = ColorPreview, CornerRadius = UDim.new(0, 4)})
            
            local PickerArea = Create("Frame", {
                Parent = ColorFrame,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 0, 0, 36),
                Size = UDim2.new(1, 0, 0, 100)
            })
            
            local HueSat = Create("ImageButton", {
                Parent = PickerArea,
                Image = "rbxassetid://4155801252",
                Position = UDim2.new(0, 10, 0, 10),
                Size = UDim2.new(0, 100, 0, 80),
                BackgroundColor3 = Color3.new(1,1,1),
                BorderSizePixel = 0,
                AutoButtonColor = false
            })
            
            local Val = Create("ImageButton", {
                Parent = PickerArea,
                BackgroundColor3 = Color3.new(1,1,1),
                Position = UDim2.new(0, 120, 0, 10),
                Size = UDim2.new(0, 20, 0, 80),
                BorderSizePixel = 0,
                AutoButtonColor = false
            })
            local ValGrad = Create("UIGradient", {
                Parent = Val,
                Rotation = 90,
                Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, Color3.new(1,1,1)),
                    ColorSequenceKeypoint.new(1, Color3.new(0,0,0))
                })
            })

            local Open = false
            ColorPreview.MouseButton1Click:Connect(function()
                Open = not Open
                TweenService:Create(ColorFrame, TweenInfo.new(0.4), {Size = Open and UDim2.new(1,0,0,146) or UDim2.new(1,0,0,36)}):Play()
            end)
            
            local h, s, v = Color3.toHSV(CurrentColor)
            
            local function Update()
                local newColor = Color3.fromHSV(h, s, v)
                ColorPreview.BackgroundColor3 = newColor
                ValGrad.Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, Color3.fromHSV(h, s, 1)),
                    ColorSequenceKeypoint.new(1, Color3.new(0,0,0))
                })
                if props.Callback then props.Callback(newColor) end
            end
            
            local DraggingHue, DraggingVal = false, false
            
            HueSat.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then DraggingHue = true end
            end)
            Val.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then DraggingVal = true end
            end)
            UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then 
                    DraggingHue = false 
                    DraggingVal = false 
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseMovement then
                    if DraggingHue then
                        local relX = math.clamp((input.Position.X - HueSat.AbsolutePosition.X) / HueSat.AbsoluteSize.X, 0, 1)
                        local relY = math.clamp((input.Position.Y - HueSat.AbsolutePosition.Y) / HueSat.AbsoluteSize.Y, 0, 1)
                        h = 1 - relX
                        s = 1 - relY
                        Update()
                    elseif DraggingVal then
                        local relY = math.clamp((input.Position.Y - Val.AbsolutePosition.Y) / Val.AbsoluteSize.Y, 0, 1)
                        v = 1 - relY
                        Update()
                    end
                end
            end)
        end

        -- [[ KEYBIND ]]
        function Section:AddKeybind(name, defaultKey, onActivate)
            local BindFrame = Create("Frame", {
                Parent = Page,
                BackgroundColor3 = Theme.LightContrast,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 36)
            })
            Create("UICorner", {Parent = BindFrame, CornerRadius = UDim.new(0, 4)})

            Create("TextLabel", {
                Parent = BindFrame,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 0),
                Size = UDim2.new(1, -80, 1, 0),
                Font = Enum.Font.Gotham,
                Text = name,
                TextColor3 = Theme.TextColor,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            local BindBtn = Create("TextButton", {
                Parent = BindFrame,
                BackgroundColor3 = Theme.DarkContrast,
                BorderSizePixel = 0,
                Position = UDim2.new(1, -80, 0.5, -12),
                Size = UDim2.new(0, 70, 0, 24),
                Font = Enum.Font.GothamBold,
                Text = (defaultKey and defaultKey.Name) or "None",
                TextColor3 = Color3.fromRGB(200, 200, 200),
                TextSize = 12,
                AutoButtonColor = false
            })
            Create("UICorner", {Parent = BindBtn, CornerRadius = UDim.new(0, 4)})
            AddRipple(BindBtn)

            local currentKey = defaultKey
            local listening = false

            BindBtn.MouseButton1Click:Connect(function()
                if listening then return end
                listening = true
                BindBtn.Text = "..."
                TweenService:Create(BindBtn, TweenInfo.new(0.2), {TextColor3 = Theme.Accent}):Play()
                
                local conn
                conn = UserInputService.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.Keyboard then
                        currentKey = input.KeyCode
                        BindBtn.Text = currentKey.Name
                        TweenService:Create(BindBtn, TweenInfo.new(0.2), {TextColor3 = Color3.fromRGB(200, 200, 200)}):Play()
                        listening = false
                        conn:Disconnect()
                    end
                end)
            end)

            UserInputService.InputBegan:Connect(function(input, gp)
                if not gp and input.KeyCode == currentKey then
                    if onActivate then onActivate() end
                end
            end)
        end
        
        return Section
    end
    
    return Library
end

return Borealis
